/*!
 * Farbtastic: jQuery color picker plug-in v1.3u
 *
 * Licensed under the GPL license:
 *   http://www.gnu.org/licenses/gpl.html
 */(function(a){a.fn.farbtastic=function(b){a.farbtastic(this,b);return this};a.farbtastic=function(b,c){var b=a(b).get(0);return b.farbtastic||(b.farbtastic=new a._farbtastic(b,c))};a._farbtastic=function(b,c){var d=this;a(b).html('<div class="farbtastic"><div class="color"></div><div class="wheel"></div><div class="overlay"></div><div class="h-marker marker"></div><div class="sl-marker marker"></div></div>');var e=a(".farbtastic",b);d.wheel=a(".wheel",b).get(0);d.radius=84;d.square=100;d.width=194;navigator.appVersion.match(/MSIE [0-6]\./)&&a("*",e).each(function(){if(this.currentStyle.backgroundImage!="none"){var b=this.currentStyle.backgroundImage;b=this.currentStyle.backgroundImage.substring(5,b.length-2);a(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+b+"')"})}});d.linkTo=function(b){typeof d.callback=="object"&&a(d.callback).unbind("keyup",d.updateValue);d.color=null;if(typeof b=="function")d.callback=b;else if(typeof b=="object"||typeof b=="string"){d.callback=a(b);d.callback.bind("keyup",d.updateValue);d.callback.get(0).value&&d.setColor(d.callback.get(0).value)}return this};d.updateValue=function(a){this.value&&this.value!=d.color&&d.setColor(this.value)};d.setColor=function(a){var b=d.unpack(a);if(d.color!=a&&b){d.color=a;d.rgb=b;d.hsl=d.RGBToHSL(d.rgb);d.updateDisplay()}return this};d.setHSL=function(a){d.hsl=a;d.rgb=d.HSLToRGB(a);d.color=d.pack(d.rgb);d.updateDisplay();return this};d.widgetCoords=function(b){var c=a(d.wheel).offset();return{x:b.pageX-c.left-d.width/2,y:b.pageY-c.top-d.width/2}};d.mousedown=function(b){if(!document.dragging){a(document).bind("mousemove",d.mousemove).bind("mouseup",d.mouseup);document.dragging=!0}var c=d.widgetCoords(b);d.circleDrag=Math.max(Math.abs(c.x),Math.abs(c.y))*2>d.square;d.mousemove(b);return!1};d.mousemove=function(a){var b=d.widgetCoords(a);if(d.circleDrag){var c=Math.atan2(b.x,-b.y)/6.28;c<0&&(c+=1);d.setHSL([c,d.hsl[1],d.hsl[2]])}else{var e=Math.max(0,Math.min(1,-(b.x/d.square)+.5)),f=Math.max(0,Math.min(1,-(b.y/d.square)+.5));d.setHSL([d.hsl[0],e,f])}return!1};d.mouseup=function(){a(document).unbind("mousemove",d.mousemove);a(document).unbind("mouseup",d.mouseup);document.dragging=!1};d.updateDisplay=function(){var b=d.hsl[0]*6.28;a(".h-marker",e).css({left:Math.round(Math.sin(b)*d.radius+d.width/2)+"px",top:Math.round(-Math.cos(b)*d.radius+d.width/2)+"px"});a(".sl-marker",e).css({left:Math.round(d.square*(.5-d.hsl[1])+d.width/2)+"px",top:Math.round(d.square*(.5-d.hsl[2])+d.width/2)+"px"});a(".color",e).css("backgroundColor",d.pack(d.HSLToRGB([d.hsl[0],1,.5])));if(typeof d.callback=="object"){a(d.callback).css({backgroundColor:d.color,color:d.hsl[2]>.5?"#000":"#fff"});a(d.callback).each(function(){this.value&&this.value!=d.color&&(this.value=d.color)})}else typeof d.callback=="function"&&d.callback.call(d,d.color)};d.pack=function(a){var b=Math.round(a[0]*255),c=Math.round(a[1]*255),d=Math.round(a[2]*255);return"#"+(b<16?"0":"")+b.toString(16)+(c<16?"0":"")+c.toString(16)+(d<16?"0":"")+d.toString(16)};d.unpack=function(a){if(a.length==7)return[parseInt("0x"+a.substring(1,3))/255,parseInt("0x"+a.substring(3,5))/255,parseInt("0x"+a.substring(5,7))/255];if(a.length==4)return[parseInt("0x"+a.substring(1,2))/15,parseInt("0x"+a.substring(2,3))/15,parseInt("0x"+a.substring(3,4))/15]};d.HSLToRGB=function(a){var b,c,d,e,f,g=a[0],h=a[1],i=a[2];c=i<=.5?i*(h+1):i+h-i*h;b=i*2-c;return[this.hueToRGB(b,c,g+.33333),this.hueToRGB(b,c,g),this.hueToRGB(b,c,g-.33333)]};d.hueToRGB=function(a,b,c){c=c<0?c+1:c>1?c-1:c;return c*6<1?a+(b-a)*c*6:c*2<1?b:c*3<2?a+(b-a)*(.66666-c)*6:a};d.RGBToHSL=function(a){var b,c,d,e,f,g,h=a[0],i=a[1],j=a[2];b=Math.min(h,Math.min(i,j));c=Math.max(h,Math.max(i,j));d=c-b;g=(b+c)/2;f=0;g>0&&g<1&&(f=d/(g<.5?2*g:2-2*g));e=0;if(d>0){c==h&&c!=i&&(e+=(i-j)/d);c==i&&c!=j&&(e+=2+(j-h)/d);c==j&&c!=h&&(e+=4+(h-i)/d);e/=6}return[e,f,g]};a("*",e).mousedown(d.mousedown);d.setColor("#000000");c&&d.linkTo(c)}})(jQuery);