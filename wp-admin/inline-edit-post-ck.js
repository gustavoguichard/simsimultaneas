(function(a){inlineEditPost={init:function(){var b=this,c=a("#inline-edit"),d=a("#bulk-edit");b.type=a("table.widefat").hasClass("pages")?"page":"post";b.what="#post-";c.keyup(function(a){if(a.which==27)return inlineEditPost.revert()});d.keyup(function(a){if(a.which==27)return inlineEditPost.revert()});a("a.cancel",c).click(function(){return inlineEditPost.revert()});a("a.save",c).click(function(){return inlineEditPost.save(this)});a("td",c).keydown(function(a){if(a.which==13)return inlineEditPost.save(this)});a("a.cancel",d).click(function(){return inlineEditPost.revert()});a('#inline-edit .inline-edit-private input[value="private"]').click(function(){var b=a("input.inline-edit-password-input");a(this).prop("checked")?b.val("").prop("disabled",!0):b.prop("disabled",!1)});a("a.editinline").live("click",function(){inlineEditPost.edit(this);return!1});a("#bulk-title-div").parents("fieldset").after(a("#inline-edit fieldset.inline-edit-categories").clone()).siblings("fieldset:last").prepend(a("#inline-edit label.inline-edit-tags").clone());a("span.catshow").click(function(){a(this).hide().next().show().parent().next().addClass("cat-hover")});a("span.cathide").click(function(){a(this).hide().prev().show().parent().next().removeClass("cat-hover")});a('select[name="_status"] option[value="future"]',d).remove();a("#doaction, #doaction2").click(function(c){var d=a(this).attr("id").substr(2);if(a('select[name="'+d+'"]').val()=="edit"){c.preventDefault();b.setBulk()}else a("form#posts-filter tr.inline-editor").length>0&&b.revert()});a("#post-query-submit").mousedown(function(c){b.revert();a('select[name^="action"]').val("-1")})},toggle:function(b){var c=this;a(c.what+c.getId(b)).css("display")=="none"?c.revert():c.edit(b)},setBulk:function(){var b="",c=this.type,d,e=!0;this.revert();a("#bulk-edit td").attr("colspan",a(".widefat:first thead th:visible").length);a("table.widefat tbody").prepend(a("#bulk-edit"));a("#bulk-edit").addClass("inline-editor").show();a('tbody th.check-column input[type="checkbox"]').each(function(c){if(a(this).prop("checked")){e=!1;var d=a(this).val(),g;g=a("#inline_"+d+" .post_title").text()||inlineEditL10n.notitle;b+='<div id="ttle'+d+'"><a id="_'+d+'" class="ntdelbutton" title="'+inlineEditL10n.ntdeltitle+'">X</a>'+g+"</div>"}});if(e)return this.revert();a("#bulk-titles").html(b);a("#bulk-titles a").click(function(){var b=a(this).attr("id").substr(1);a('table.widefat input[value="'+b+'"]').prop("checked",!1);a("#ttle"+b).remove()});if("post"==c){d="post_tag";a('tr.inline-editor textarea[name="tax_input['+d+']"]').suggest(ajaxurl+"?action=ajax-tag-search&tax="+d,{delay:500,minchars:2,multiple:!0,multipleSep:inlineEditL10n.comma+" "})}a("html, body").animate({scrollTop:0},"fast")},edit:function(b){var c=this,d,e,f,g,h,i,j,k=!0,l,m,n;c.revert();typeof b=="object"&&(b=c.getId(b));d=["post_title","post_name","post_author","_status","jj","mm","aa","hh","mn","ss","post_password","post_format","menu_order"];c.type=="page"&&d.push("post_parent","page_template");e=a("#inline-edit").clone(!0);a("td",e).attr("colspan",a(".widefat:first thead th:visible").length);a(c.what+b).hasClass("alternate")&&a(e).addClass("alternate");a(c.what+b).hide().after(e);f=a("#inline_"+b);a(':input[name="post_author"] option[value="'+a(".post_author",f).text()+'"]',e).val()||a(':input[name="post_author"]',e).prepend('<option value="'+a(".post_author",f).text()+'">'+a("#"+c.type+"-"+b+" .author").text()+"</option>");a(':input[name="post_author"] option',e).length==1&&a("label.inline-edit-author",e).hide();m=a(".post_format",f).text();a("option.unsupported",e).each(function(){var b=a(this);b.val()!=m&&b.remove()});for(n=0;n<d.length;n++)a(':input[name="'+d[n]+'"]',e).val(a("."+d[n],f).text());a(".comment_status",f).text()=="open"&&a('input[name="comment_status"]',e).prop("checked",!0);a(".ping_status",f).text()=="open"&&a('input[name="ping_status"]',e).prop("checked",!0);a(".sticky",f).text()=="sticky"&&a('input[name="sticky"]',e).prop("checked",!0);a(".post_category",f).each(function(){var c=a(this).text();if(c){taxname=a(this).attr("id").replace("_"+b,"");a("ul."+taxname+"-checklist :checkbox",e).val(c.split(","))}});a(".tags_input",f).each(function(){var c=a(this).text(),d=a(this).attr("id").replace("_"+b,""),f=a("textarea.tax_input_"+d,e),g=inlineEditL10n.comma;if(c){","!==g&&(c=c.replace(/,/g,g));f.val(c)}f.suggest(ajaxurl+"?action=ajax-tag-search&tax="+d,{delay:500,minchars:2,multiple:!0,multipleSep:inlineEditL10n.comma+" "})});g=a("._status",f).text();"future"!=g&&a('select[name="_status"] option[value="future"]',e).remove();if("private"==g){a('input[name="keep_private"]',e).prop("checked",!0);a("input.inline-edit-password-input").val("").prop("disabled",!0)}h=a('select[name="post_parent"] option[value="'+b+'"]',e);if(h.length>0){i=h[0].className.split("-")[1];j=h;while(k){j=j.next("option");if(j.length==0)break;l=j[0].className.split("-")[1];if(l<=i)k=!1;else{j.remove();j=h}}h.remove()}a(e).attr("id","edit-"+b).addClass("inline-editor").show();a(".ptitle",e).focus();return!1},save:function(b){var c,d,e=a(".post_status_page").val()||"";typeof b=="object"&&(b=this.getId(b));a("table.widefat .inline-edit-save .waiting").show();c={action:"inline-save",post_type:typenow,post_ID:b,edit_date:"true",post_status:e};d=a("#edit-"+b+" :input").serialize();c=d+"&"+a.param(c);a.post(ajaxurl,c,function(c){a("table.widefat .inline-edit-save .waiting").hide();if(c)if(-1!=c.indexOf("<tr")){a(inlineEditPost.what+b).remove();a("#edit-"+b).before(c).remove();a(inlineEditPost.what+b).hide().fadeIn()}else{c=c.replace(/<.[^<>]*?>/g,"");a("#edit-"+b+" .inline-edit-save .error").html(c).show()}else a("#edit-"+b+" .inline-edit-save .error").html(inlineEditL10n.error).show()},"html");return!1},revert:function(){var b=a("table.widefat tr.inline-editor").attr("id");if(b){a("table.widefat .inline-edit-save .waiting").hide();if("bulk-edit"==b){a("table.widefat #bulk-edit").removeClass("inline-editor").hide();a("#bulk-titles").html("");a("#inlineedit").append(a("#bulk-edit"))}else{a("#"+b).remove();b=b.substr(b.lastIndexOf("-")+1);a(this.what+b).show()}}return!1},getId:function(b){var c=a(b).closest("tr").attr("id"),d=c.split("-");return d[d.length-1]}};a(document).ready(function(){inlineEditPost.init()})})(jQuery);