function array_unique_noempty(a){var b=[];jQuery.each(a,function(a,c){c=jQuery.trim(c);c&&jQuery.inArray(c,b)==-1&&b.push(c)});return b}var tagBox,commentsBox,editPermalink,makeSlugeditClickable,WPSetThumbnailHTML,WPSetThumbnailID,WPRemoveThumbnail,wptitlehint;(function(a){tagBox={clean:function(a){var b=postL10n.comma;","!==b&&(a=a.replace(new RegExp(b,"g"),","));a=a.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,"");","!==b&&(a=a.replace(/,/g,b));return a},parseTags:function(b){var c=b.id,d=c.split("-check-num-")[1],e=a(b).closest(".tagsdiv"),f=e.find(".the-tags"),g=postL10n.comma,h=f.val().split(g),i=[];delete h[d];a.each(h,function(b,c){c=a.trim(c);c&&i.push(c)});f.val(this.clean(i.join(g)));this.quickClicks(e);return!1},quickClicks:function(b){var c=a(".the-tags",b),d=a(".tagchecklist",b),e=a(b).attr("id"),f,g;if(!c.length)return;g=c.prop("disabled");f=c.val().split(postL10n.comma);d.empty();a.each(f,function(b,c){var f,h;c=a.trim(c);if(!c)return;f=a("<span />").text(c);if(!g){h=a('<a id="'+e+"-check-num-"+b+'" class="ntdelbutton">X</a>');h.click(function(){tagBox.parseTags(this)});f.prepend("&nbsp;").prepend(h)}d.append(f)})},flushTags:function(b,c,d){c=c||!1;var e=a(".the-tags",b),f=a("input.newtag",b),g=postL10n.comma,h,i;i=c?a(c).text():f.val();tagsval=e.val();h=tagsval?tagsval+g+i:i;h=this.clean(h);h=array_unique_noempty(h.split(g)).join(g);e.val(h);this.quickClicks(b);c||f.val("");"undefined"==typeof d&&f.focus();return!1},get:function(b){var c=b.substr(b.indexOf("-")+1);a.post(ajaxurl,{action:"get-tagcloud",tax:c},function(d,e){if(0==d||"success"!=e)d=wpAjax.broken;d=a('<p id="tagcloud-'+c+'" class="the-tagcloud">'+d+"</p>");a("a",d).click(function(){tagBox.flushTags(a(this).closest(".inside").children(".tagsdiv"),this);return!1});a("#"+b).after(d)})},init:function(){var b=this,c=a("div.ajaxtag");a(".tagsdiv").each(function(){tagBox.quickClicks(this)});a("input.tagadd",c).click(function(){b.flushTags(a(this).closest(".tagsdiv"))});a("div.taghint",c).click(function(){a(this).css("visibility","hidden").parent().siblings(".newtag").focus()});a("input.newtag",c).blur(function(){this.value==""&&a(this).parent().siblings(".taghint").css("visibility","")}).focus(function(){a(this).parent().siblings(".taghint").css("visibility","hidden")}).keyup(function(b){if(13==b.which){tagBox.flushTags(a(this).closest(".tagsdiv"));return!1}}).keypress(function(a){if(13==a.which){a.preventDefault();return!1}}).each(function(){var b=a(this).closest("div.tagsdiv").attr("id");a(this).suggest(ajaxurl+"?action=ajax-tag-search&tax="+b,{delay:500,minchars:2,multiple:!0,multipleSep:postL10n.comma+" "})});a("#post").submit(function(){a("div.tagsdiv").each(function(){tagBox.flushTags(this,!1,1)})});a("a.tagcloud-link").click(function(){tagBox.get(a(this).attr("id"));a(this).unbind().click(function(){a(this).siblings(".the-tagcloud").toggle();return!1});return!1})}};commentsBox={st:0,get:function(b,c){var d=this.st,e;c||(c=20);this.st+=c;this.total=b;a("#commentsdiv img.waiting").show();e={action:"get-comments",mode:"single",_ajax_nonce:a("#add_comment_nonce").val(),p:a("#post_ID").val(),start:d,number:c};a.post(ajaxurl,e,function(b){b=wpAjax.parseAjaxResponse(b);a("#commentsdiv .widefat").show();a("#commentsdiv img.waiting").hide();if("object"==typeof b&&b.responses[0]){a("#the-comment-list").append(b.responses[0].data);theList=theExtraList=null;a("a[className*=':']").unbind();commentsBox.st>commentsBox.total?a("#show-comments").hide():a("#show-comments").show().children("a").html(postL10n.showcomm);return}if(1==b){a("#show-comments").html(postL10n.endcomm);return}a("#the-comment-list").append('<tr><td colspan="2">'+wpAjax.broken+"</td></tr>")});return!1}};WPSetThumbnailHTML=function(b){a(".inside","#postimagediv").html(b)};WPSetThumbnailID=function(b){var c=a('input[value="_thumbnail_id"]',"#list-table");c.size()>0&&a("#meta\\["+c.attr("id").match(/[0-9]+/)+"\\]\\[value\\]").text(b)};WPRemoveThumbnail=function(b){a.post(ajaxurl,{action:"set-post-thumbnail",post_id:a("#post_ID").val(),thumbnail_id:-1,_ajax_nonce:b,cookie:encodeURIComponent(document.cookie)},function(a){a=="0"?alert(setPostThumbnailL10n.error):WPSetThumbnailHTML(a)})}})(jQuery);jQuery(document).ready(function(a){var b,c,d="",e=0,f=a("#content");postboxes.add_postbox_toggles(pagenow);a("#tagsdiv-post_tag").length?tagBox.init():a("#side-sortables, #normal-sortables, #advanced-sortables").children("div.postbox").each(function(){if(this.id.indexOf("tagsdiv-")===0){tagBox.init();return!1}});a(".categorydiv").each(function(){var b=a(this).attr("id"),c=!1,d,e,f,g,h;f=b.split("-");f.shift();g=f.join("-");h=g+"_tab";g=="category"&&(h="cats");a("a","#"+g+"-tabs").click(function(){var b=a(this).attr("href");a(this).parent().addClass("tabs").siblings("li").removeClass("tabs");a("#"+g+"-tabs").siblings(".tabs-panel").hide();a(b).show();"#"+g+"-all"==b?deleteUserSetting(h):setUserSetting(h,"pop");return!1});getUserSetting(h)&&a('a[href="#'+g+'-pop"]',"#"+g+"-tabs").click();a("#new"+g).one("focus",function(){a(this).val("").removeClass("form-input-tip")});a("#"+g+"-add-submit").click(function(){a("#new"+g).focus()});d=function(){if(c)return;c=!0;var b=jQuery(this),d=b.is(":checked"),e=b.val().toString();a("#in-"+g+"-"+e+", #in-"+g+"-category-"+e).prop("checked",d);c=!1};catAddBefore=function(b){if(!a("#new"+g).val())return!1;b.data+="&"+a(":checked","#"+g+"checklist").serialize();a("#"+g+"-add-submit").prop("disabled",!0);return b};e=function(b,c){var d,e=a("#new"+g+"_parent");a("#"+g+"-add-submit").prop("disabled",!1);if("undefined"!=c.parsed.responses[0]&&(d=c.parsed.responses[0].supplemental.newcat_parent)){e.before(d);e.remove()}};a("#"+g+"checklist").wpList({alt:"",response:g+"-ajax-response",addBefore:catAddBefore,addAfter:e});a("#"+g+"-add-toggle").click(function(){a("#"+g+"-adder").toggleClass("wp-hidden-children");a('a[href="#'+g+'-all"]',"#"+g+"-tabs").click();a("#new"+g).focus();return!1});a("#"+g+"checklist li.popular-category :checkbox, #"+g+"checklist-pop :checkbox").live("click",function(){var b=a(this),c=b.is(":checked"),d=b.val();d&&b.parents("#taxonomy-"+g).length&&a("#in-"+g+"-"+d+", #in-popular-"+g+"-"+d).prop("checked",c)})});a("#postcustom").length&&a("#the-list").wpList({addAfter:function(b,c){a("table#list-table").show()},addBefore:function(b){b.data+="&post_id="+a("#post_ID").val();return b}});if(a("#submitdiv").length){b=a("#timestamp").html();c=a("#post-visibility-display").html();function g(){var b=a("#post-visibility-select");if(a("input:radio:checked",b).val()!="public"){a("#sticky").prop("checked",!1);a("#sticky-span").hide()}else a("#sticky-span").show();a("input:radio:checked",b).val()!="password"?a("#password-span").hide():a("#password-span").show()}function h(){var c,d,e,f,g=a("#post_status"),h=a('option[value="publish"]',g),i=a("#aa").val(),j=a("#mm").val(),k=a("#jj").val(),l=a("#hh").val(),m=a("#mn").val();c=new Date(i,j-1,k,l,m);d=new Date(a("#hidden_aa").val(),a("#hidden_mm").val()-1,a("#hidden_jj").val(),a("#hidden_hh").val(),a("#hidden_mn").val());e=new Date(a("#cur_aa").val(),a("#cur_mm").val()-1,a("#cur_jj").val(),a("#cur_hh").val(),a("#cur_mn").val());if(c.getFullYear()!=i||1+c.getMonth()!=j||c.getDate()!=k||c.getMinutes()!=m){a(".timestamp-wrap","#timestampdiv").addClass("form-invalid");return!1}a(".timestamp-wrap","#timestampdiv").removeClass("form-invalid");if(c>e&&a("#original_post_status").val()!="future"){f=postL10n.publishOnFuture;a("#publish").val(postL10n.schedule)}else if(c<=e&&a("#original_post_status").val()!="publish"){f=postL10n.publishOn;a("#publish").val(postL10n.publish)}else{f=postL10n.publishOnPast;a("#publish").val(postL10n.update)}d.toUTCString()==c.toUTCString()?a("#timestamp").html(b):a("#timestamp").html(f+" <b>"+a('option[value="'+a("#mm").val()+'"]',"#mm").text()+" "+k+", "+i+" @ "+l+":"+m+"</b> ");if(a("input:radio:checked","#post-visibility-select").val()=="private"){a("#publish").val(postL10n.update);h.length==0?g.append('<option value="publish">'+postL10n.privatelyPublished+"</option>"):h.html(postL10n.privatelyPublished);a('option[value="publish"]',g).prop("selected",!0);a(".edit-post-status","#misc-publishing-actions").hide()}else{if(a("#original_post_status").val()=="future"||a("#original_post_status").val()=="draft"){if(h.length){h.remove();g.val(a("#hidden_post_status").val())}}else h.html(postL10n.published);g.is(":hidden")&&a(".edit-post-status","#misc-publishing-actions").show()}a("#post-status-display").html(a("option:selected",g).text());if(a("option:selected",g).val()=="private"||a("option:selected",g).val()=="publish")a("#save-post").hide();else{a("#save-post").show();a("option:selected",g).val()=="pending"?a("#save-post").show().val(postL10n.savePending):a("#save-post").show().val(postL10n.saveDraft)}return!0}a(".edit-visibility","#visibility").click(function(){if(a("#post-visibility-select").is(":hidden")){g();a("#post-visibility-select").slideDown("fast");a(this).hide()}return!1});a(".cancel-post-visibility","#post-visibility-select").click(function(){a("#post-visibility-select").slideUp("fast");a("#visibility-radio-"+a("#hidden-post-visibility").val()).prop("checked",!0);a("#post_password").val(a("#hidden_post_password").val());a("#sticky").prop("checked",a("#hidden-post-sticky").prop("checked"));a("#post-visibility-display").html(c);a(".edit-visibility","#visibility").show();h();return!1});a(".save-post-visibility","#post-visibility-select").click(function(){var b=a("#post-visibility-select");b.slideUp("fast");a(".edit-visibility","#visibility").show();h();a("input:radio:checked",b).val()!="public"&&a("#sticky").prop("checked",!1);1==a("#sticky").prop("checked")?d="Sticky":d="";a("#post-visibility-display").html(postL10n[a("input:radio:checked",b).val()+d]);return!1});a("input:radio","#post-visibility-select").change(function(){g()});a("#timestampdiv").siblings("a.edit-timestamp").click(function(){if(a("#timestampdiv").is(":hidden")){a("#timestampdiv").slideDown("fast");a(this).hide()}return!1});a(".cancel-timestamp","#timestampdiv").click(function(){a("#timestampdiv").slideUp("fast");a("#mm").val(a("#hidden_mm").val());a("#jj").val(a("#hidden_jj").val());a("#aa").val(a("#hidden_aa").val());a("#hh").val(a("#hidden_hh").val());a("#mn").val(a("#hidden_mn").val());a("#timestampdiv").siblings("a.edit-timestamp").show();h();return!1});a(".save-timestamp","#timestampdiv").click(function(){if(h()){a("#timestampdiv").slideUp("fast");a("#timestampdiv").siblings("a.edit-timestamp").show()}return!1});a("#post-status-select").siblings("a.edit-post-status").click(function(){if(a("#post-status-select").is(":hidden")){a("#post-status-select").slideDown("fast");a(this).hide()}return!1});a(".save-post-status","#post-status-select").click(function(){a("#post-status-select").slideUp("fast");a("#post-status-select").siblings("a.edit-post-status").show();h();return!1});a(".cancel-post-status","#post-status-select").click(function(){a("#post-status-select").slideUp("fast");a("#post_status").val(a("#hidden_post_status").val());a("#post-status-select").siblings("a.edit-post-status").show();h();return!1})}if(a("#edit-slug-box").length){editPermalink=function(b){var c,d=0,e=a("#editable-post-name"),f=e.html(),g=a("#post_name"),h=g.val(),i=a("#edit-slug-buttons"),j=i.html(),k=a("#editable-post-name-full").html();a("#view-post-btn").hide();i.html('<a href="#" class="save button">'+postL10n.ok+'</a> <a class="cancel" href="#">'+postL10n.cancel+"</a>");i.children(".save").click(function(){var c=e.children("input").val();if(c==a("#editable-post-name-full").text())return a(".cancel","#edit-slug-buttons").click();a.post(ajaxurl,{action:"sample-permalink",post_id:b,new_slug:c,new_title:a("#title").val(),samplepermalinknonce:a("#samplepermalinknonce").val()},function(b){a("#edit-slug-box").html(b);i.html(j);g.val(c);makeSlugeditClickable();a("#view-post-btn").show()});return!1});a(".cancel","#edit-slug-buttons").click(function(){a("#view-post-btn").show();e.html(f);i.html(j);g.val(h);return!1});for(c=0;c<k.length;++c)"%"==k.charAt(c)&&d++;slug_value=d>k.length/4?"":k;e.html('<input type="text" id="new-post-slug" value="'+slug_value+'" />').children("input").keypress(function(a){var b=a.keyCode||0;if(13==b){i.children(".save").click();return!1}if(27==b){i.children(".cancel").click();return!1}g.val(this.value)}).focus()};makeSlugeditClickable=function(){a("#editable-post-name").click(function(){a("#edit-slug-buttons").children(".edit-slug").click()})};makeSlugeditClickable()}if(typeof wpWordCount!="undefined"){a(document).triggerHandler("wpcountwords",[f.val()]);f.keyup(function(b){var c=b.keyCode||b.charCode;if(c==e)return!0;(13==c||8==e||46==e)&&a(document).triggerHandler("wpcountwords",[f.val()]);e=c;return!0})}wptitlehint=function(b){b=b||"title";var c=a("#"+b),d=a("#"+b+"-prompt-text");c.val()==""&&d.css("visibility","");d.click(function(){a(this).css("visibility","hidden");c.focus()});c.blur(function(){this.value==""&&d.css("visibility","")}).focus(function(){d.css("visibility","hidden")}).keydown(function(b){d.css("visibility","hidden");a(this).unbind(b)})};wptitlehint()});