(function(e){e.fn.tagGenerator=function(t,n){var r=e('<div class="tag-generator"></div>'),i=e("<span>"+t+"</span>");i.css({border:"1px solid #ddd",padding:"2px 4px",background:"#fff url( ../wp-admin/images/fade-butt.png ) repeat-x 0 0","-moz-border-radius":"3px","-khtml-border-radius":"3px","-webkit-border-radius":"3px","border-radius":"3px"});i.mouseover(function(){e(this).css({"border-color":"#bbb"})});i.mouseout(function(){e(this).css({"border-color":"#ddd"})});i.mousedown(function(){e(this).css({background:"#ddd"})});i.mouseup(function(){e(this).css({background:"#fff url( ../wp-admin/images/fade-butt.png ) repeat-x 0 0"})});i.click(function(){u.slideDown("fast");return!1});e("body").click(function(){u.hide()});if(n.dropdownIconUrl){var s=e('<img src="'+n.dropdownIconUrl+'" />');s.css({"vertical-align":"bottom"});i.append(s)}r.append(i);var o=e('<div class="tg-pane"></div>');o.hide();r.append(o);var u=e('<div class="tg-dropdown"></div>');u.hide();r.append(u);e.each(e.tgPanes,function(t,n){var r=e("<div>"+e.tgPanes[t].title+"</div>");r.css({margin:0,padding:"0 4px","line-height":"180%",background:"#fff"});r.mouseover(function(){e(this).css({background:"#d4f2f2"})});r.mouseout(function(){e(this).css({background:"#fff"})});r.click(function(){u.hide();o.hide();o.empty();e.tgPane(o,t);o.slideDown("fast");return!1});u.append(r)});this.append(r)};e.tgPane=function(t,n){var r=e("<div></div>");r.css({"float":"right"});var i=e('<span class="tg-closebutton">&#215;</span>');i.click(function(){t.slideUp("fast").empty()});r.append(i);t.append(r);var s=e('<div class="tg-panetitle">'+e.tgPanes[n].title+"</div>");t.append(s);t.append(e("#"+e.tgPanes[n].content).clone().contents());t.find(":checkbox.exclusive").change(function(){e(this).is(":checked")&&e(this).siblings(":checkbox.exclusive").removeAttr("checked")});e.isFunction(e.tgPanes[n].change)?e.tgPanes[n].change(t,n):e.tgCreateTag(t,n);t.find(":input").change(function(){e.isFunction(e.tgPanes[n].change)?e.tgPanes[n].change(t,n):e.tgCreateTag(t,n)})};e.tgCreateTag=function(t,n){t.find('input[name="name"]').each(function(t){var r=e(this).val();r=r.replace(/[^0-9a-zA-Z:._-]/g,"").replace(/^[^a-zA-Z]+/,"");if(""==r){var i=Math.floor(Math.random()*1e3);r=n+"-"+i}e(this).val(r)});t.find(":input.numeric").each(function(t){var n=e(this).val();n=n.replace(/[^0-9]/g,"");e(this).val(n)});t.find(":input.idvalue").each(function(t){var n=e(this).val();n=n.replace(/[^-0-9a-zA-Z_]/g,"");e(this).val(n)});t.find(":input.classvalue").each(function(t){var n=e(this).val();n=e.map(n.split(" "),function(e){return e.replace(/[^-0-9a-zA-Z_]/g,"")}).join(" ");n=e.trim(n.replace(/\s+/g," "));e(this).val(n)});t.find(":input.color").each(function(t){var n=e(this).val();n=n.replace(/[^0-9a-fA-F]/g,"");e(this).val(n)});t.find(":input.filesize").each(function(t){var n=e(this).val();n=n.replace(/[^0-9kKmMbB]/g,"");e(this).val(n)});t.find(":input.filetype").each(function(t){var n=e(this).val();n=n.replace(/[^0-9a-zA-Z.,|\s]/g,"");e(this).val(n)});t.find(":input.date").each(function(t){var n=e(this).val();n.match(/^\d{4}-\d{1,2}-\d{1,2}$/)||e(this).val("")});t.find(':input[name="values"]').each(function(t){var n=e(this).val();n=e.trim(n);e(this).val(n)});t.find("input.tag").each(function(r){var i=e(this).attr("name"),s=t.find(".scope."+i);s.length||(s=t);t.find(':input[name="required"]').is(":checked")&&(i+="*");var o=t.find(':input[name="name"]').val(),u=[],a=s.find(':input[name="size"]').val(),f=s.find(':input[name="maxlength"]').val();(a||f)&&u.push(a+"/"+f);var l=s.find(':input[name="cols"]').val(),c=s.find(':input[name="rows"]').val();(l||c)&&u.push(l+"x"+c);s.find("input:text.option").each(function(t){if(-1<e.inArray(e(this).attr("name"),["size","maxlength","cols","rows"]))return;var n=e(this).val();if(!n)return;e(this).hasClass("filetype")&&(n=n.split(/[,|\s]+/).join("|"));e(this).hasClass("color")&&(n="#"+n);"class"==e(this).attr("name")?e.each(n.split(" "),function(e,t){u.push("class:"+t)}):u.push(e(this).attr("name")+":"+n)});s.find("input:checkbox.option").each(function(t){e(this).is(":checked")&&u.push(e(this).attr("name"))});u=u.length>0?" "+u.join(" "):"";var h="";s.find(':input[name="values"]').val()&&e.each(s.find(':input[name="values"]').val().split("\n"),function(e,t){h+=' "'+t.replace(/["]/g,"&quot;")+'"'});if(e.tgPanes[n].nameless)var p="["+i+u+h+"]";else var p=o?"["+i+" "+o+u+h+"]":"";e(this).val(p)});t.find("input.mail-tag").each(function(n){var r=t.find(':input[name="name"]').val(),i=r?"["+r+"]":"";e(this).val(i)})};e.tgPanes={}})(jQuery);