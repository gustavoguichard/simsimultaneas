(function(a,b,c,d){function g(){var a;try{a=navigator.plugins["Shockwave Flash"];a=a.description}catch(b){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(c){a="0.0"}}a=a.match(/\d+/g);return parseFloat(a[0]+"."+a[1])}var e={},f={};c.flash={trigger:function(a,b,c){setTimeout(function(){var d=e[a],f,g;d&&d.trigger("Flash:"+b,c)},0)}};c.runtimes.Flash=c.addRuntime("flash",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,maxWidth:8091,maxHeight:8091,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(a,d){function l(){return b.getElementById(a.id+"_flash")}function m(){if(j++>5e3){d({success:!1});return}f[a.id]===!1&&setTimeout(m,1)}var h,i,j=0,k=b.body;if(g()<10){d({success:!1});return}f[a.id]=!1;e[a.id]=a;h=b.getElementById(a.settings.browse_button);i=b.createElement("div");i.id=a.id+"_flash_container";c.extend(i.style,{position:"absolute",top:"0px",background:a.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"});i.className="plupload flash";if(a.settings.container){k=b.getElementById(a.settings.container);c.getStyle(k,"position")==="static"&&(k.style.position="relative")}k.appendChild(i);(function(){var d,e;d='<object id="'+a.id+'_flash" type="application/x-shockwave-flash" data="'+a.settings.flash_swf_url+'" ';c.ua.ie&&(d+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');d+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+a.settings.flash_swf_url+'" /><param name="flashvars" value="id='+escape(a.id)+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';if(c.ua.ie){e=b.createElement("div");i.appendChild(e);e.outerHTML=d;e=null}else i.innerHTML=d})();m();h=i=null;a.bind("Destroy",function(a){var d;c.removeAllEvents(b.body,a.id);delete f[a.id];delete e[a.id];d=b.getElementById(a.id+"_flash_container");d&&k.removeChild(d)});a.bind("Flash:Init",function(){var e={},g;try{l().setFileFilters(a.settings.filters,a.settings.multi_selection)}catch(h){d({success:!1});return}if(f[a.id])return;f[a.id]=!0;a.bind("UploadFile",function(b,d){var f=b.settings,g=a.settings.resize||{};l().uploadFile(e[d.id],f.url,{name:d.target_name||d.name,mime:c.mimeTypes[d.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:f.chunk_size,width:g.width,height:g.height,quality:g.quality,multipart:f.multipart,multipart_params:f.multipart_params||{},file_data_name:f.file_data_name,format:/\.(jpg|jpeg)$/i.test(d.name)?"jpg":"png",headers:f.headers,urlstream_upload:f.urlstream_upload})});a.bind("CancelUpload",function(){l().cancelUpload()});a.bind("Flash:UploadProcess",function(a,b){var d=a.getFile(e[b.id]);if(d.status!=c.FAILED){d.loaded=b.loaded;d.size=b.size;a.trigger("UploadProgress",d)}});a.bind("Flash:UploadChunkComplete",function(a,b){var d,f=a.getFile(e[b.id]);d={chunk:b.chunk,chunks:b.chunks,response:b.text};a.trigger("ChunkUploaded",f,d);f.status!==c.FAILED&&a.state!==c.STOPPED&&l().uploadNextChunk();if(b.chunk==b.chunks-1){f.status=c.DONE;a.trigger("FileUploaded",f,{response:b.text})}});a.bind("Flash:SelectFiles",function(b,d){var f,g,h=[],i;for(g=0;g<d.length;g++){f=d[g];i=c.guid();e[i]=f.id;e[f.id]=i;h.push(new c.File(i,f.name,f.size))}h.length&&a.trigger("FilesAdded",h)});a.bind("Flash:SecurityError",function(b,d){a.trigger("Error",{code:c.SECURITY_ERROR,message:c.translate("Security error."),details:d.message,file:a.getFile(e[d.id])})});a.bind("Flash:GenericError",function(b,d){a.trigger("Error",{code:c.GENERIC_ERROR,message:c.translate("Generic error."),details:d.message,file:a.getFile(e[d.id])})});a.bind("Flash:IOError",function(b,d){a.trigger("Error",{code:c.IO_ERROR,message:c.translate("IO error."),details:d.message,file:a.getFile(e[d.id])})});a.bind("Flash:ImageError",function(b,d){a.trigger("Error",{code:parseInt(d.code,10),message:c.translate("Image error."),file:a.getFile(e[d.id])})});a.bind("Flash:StageEvent:rollOver",function(d){var e,f;e=b.getElementById(a.settings.browse_button);f=d.settings.browse_button_hover;e&&f&&c.addClass(e,f)});a.bind("Flash:StageEvent:rollOut",function(d){var e,f;e=b.getElementById(a.settings.browse_button);f=d.settings.browse_button_hover;e&&f&&c.removeClass(e,f)});a.bind("Flash:StageEvent:mouseDown",function(d){var e,f;e=b.getElementById(a.settings.browse_button);f=d.settings.browse_button_active;if(e&&f){c.addClass(e,f);c.addEvent(b.body,"mouseup",function(){c.removeClass(e,f)},d.id)}});a.bind("Flash:StageEvent:mouseUp",function(d){var e,f;e=b.getElementById(a.settings.browse_button);f=d.settings.browse_button_active;e&&f&&c.removeClass(e,f)});a.bind("Flash:ExifData",function(b,c){a.trigger("ExifData",a.getFile(e[c.id]),c.data)});a.bind("Flash:GpsData",function(b,c){a.trigger("GpsData",a.getFile(e[c.id]),c.data)});a.bind("QueueChanged",function(b){a.refresh()});a.bind("FilesRemoved",function(a,b){var c;for(c=0;c<b.length;c++)l().removeFile(e[b[c].id])});a.bind("StateChanged",function(b){a.refresh()});a.bind("Refresh",function(d){var e,f,g;l().setFileFilters(a.settings.filters,a.settings.multi_selection);e=b.getElementById(d.settings.browse_button);if(e){f=c.getPos(e,b.getElementById(d.settings.container));g=c.getSize(e);c.extend(b.getElementById(d.id+"_flash_container").style,{top:f.y+"px",left:f.x+"px",width:g.w+"px",height:g.h+"px"})}});a.bind("DisableBrowse",function(a,b){l().disableBrowse(b)});d({success:!0})})}})})(window,document,plupload);